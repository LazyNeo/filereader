"use strict";webpackJsonp([2],{361:function(t,e,a){function i(t){a(432)}var s=a(18)(a(386),a(462),i,"data-v-3dba5412",null);t.exports=s.exports},362:function(t,e,a){function i(t){a(445)}var s=a(18)(a(387),a(476),i,"data-v-9a35a876",null);t.exports=s.exports},363:function(t,e,a){function i(t){a(436)}var s=a(18)(a(388),a(466),i,"data-v-537323c2",null);t.exports=s.exports},364:function(t,e,a){var i=a(18)(null,a(456),null,null,null);t.exports=i.exports},386:function(t,e,a){Object.defineProperty(e,"__esModule",{value:!0});var i=a(82),s=a.n(i),n=a(39),r=a.n(n),o=a(37),l=a(40),d=a.n(l);e.default={data:function(){return{tableData:[],tableData2:[],tableData3:[],cardId:"0001143660",userInfo:{},inputData:"",lastEditTime:Date.now(),handlerTimmer:null,timer:null}},methods:{getUserInfo:function(t){var e=this,i=t.cardId;if(this.userInfo.card_id!==i){var s={card_id:i};a.i(o.a)("getUserInfoByCardId",s).then(function(t){if(0!==t.code)return void window.M6.alert(t.msg);e.userInfo.card_id&&a.i(o.a)("unlockCard",{card_id:e.userInfo.card_id,store:e.userInfo.store}),e.userInfo=t.data})}},deleteRow:function(t,e){e.splice(t,1)},addProduct:function(t){var e=this,i=t.plu,s=void 0===i?"":i,n=t.code,r=void 0===n?"":n,l=t.weight,d=void 0===l?1:l;if(!s&&!r)return void M6.alert("商品条码不正确，请重新扫描或输入");var c={plu:s,code:r};a.i(o.a)("getGoodsInfoByPlu",c).then(function(t){if(0!==t.code)return void window.M6.alert(t.msg);t.data.count=d,e.tableData.push(t.data)})},pay:function(){if("{}"===r()(this.userInfo))return void window.M6.alert("您还未刷卡登陆哦~",-1,function(){});this.$router.push({name:"posPay",params:{statistic:r()(this.statistic)}})},getFocus:function(){var t=this;this.timer=setInterval(function(){t.$refs.pos_cmd_input.focus()},1e3)},submitTest:function(){if(M6Config.ifDev&&this.inputData){this.handlerTimmer&&(clearTimeout(this.handlerTimmer),this.handlerTimmer=null);var t=this.inputData;return this.inputData="",13===t.length?void this.goodInputHandler(t):10===t.length?void this.cardInputHandler(t):void this.addProduct({plu:t,weight:Math.floor(1+5*Math.random())})}},goodInputHandler:function(t){if(t.startsWith("20")){var e=Number(t.substr(3,4)),a=Number(t.substr(7,5))/1e3;return void this.addProduct({plu:e,weight:a})}this.addProduct({code:t,weight:1})},cardInputHandler:function(t){this.getUserInfo({cardId:t})},parentHandler:function(t){if(t)return this.inputData="",10===t.length&&t.startsWith("00")?void this.cardInputHandler(t):13===t.length?void this.goodInputHandler(t):void 0}},computed:{computedTableData:function(){var t=CK.deepCopy(this.tableData);if(this.userInfo.card_id)if("V"===this.userInfo.class){var e=!0,a=!1,i=void 0;try{for(var n,r=s()(t);!(e=(n=r.next()).done);e=!0){var o=n.value;o.act_price=o.p_price*o.count,o.discount=o.price*o.count-o.act_price}}catch(t){a=!0,i=t}finally{try{!e&&r.return&&r.return()}finally{if(a)throw i}}}else{var l=!0,d=!1,c=void 0;try{for(var u,p=s()(t);!(l=(u=p.next()).done);l=!0){var v=u.value;v.act_price=v.card_price*v.count,v.discount=v.price*v.count-v.act_price}}catch(t){d=!0,c=t}finally{try{!l&&p.return&&p.return()}finally{if(d)throw c}}}else{var m=!0,f=!1,h=void 0;try{for(var _,b=s()(t);!(m=(_=b.next()).done);m=!0){var x=_.value;x.act_price=x.price*x.count,x.discount=0}}catch(t){f=!0,h=t}finally{try{!m&&b.return&&b.return()}finally{if(f)throw h}}}return t},statistic:function(){var t={totalPrice:0,needPay:0,discount:0,num:0,kind:0},e={},a=0,i=!0,n=!1,r=void 0;try{for(var o,l=s()(this.computedTableData);!(i=(o=l.next()).done);i=!0){var d=o.value;e[d.plu]||(e[d.plu]=!0,a++),t.totalPrice+=d.price*d.count,t.needPay+=d.act_price}}catch(t){n=!0,r=t}finally{try{!i&&l.return&&l.return()}finally{if(n)throw r}}return t.discount=Number(t.totalPrice-t.needPay).toFixed(2),t.num=this.computedTableData.length,t.kind=a,t}},components:{},beforeRouteEnter:function(t,e,a){a(function(t){"posPayResult"===e.name&&(t.tableData=[],t.userInfo={})})},watch:{inputData:function(t,e){var a=this;this.lastEditTime=Date.now(),this.handlerTimmer&&(clearTimeout(this.handlerTimmer),this.handlerTimmer=null),this.handlerTimmer=setTimeout(function(){a.parentHandler(t)},1e3)}},created:function(){var t=this;if(this.getFocus(),setInterval(function(){Date.now()-t.lastEditTime>5e3&&(t.inputData="")},1e3),!M6Config.ifDev){d.a.Window.get().enterFullscreen()}},destroyed:function(){clearTimeout(this.timer),this.timer=null}}},387:function(t,e,a){Object.defineProperty(e,"__esModule",{value:!0}),e.default={data:function(){return{statistic:{}}},methods:{payConfirm:function(){this.$router.push({name:"posPayResult"})}},beforeRouteEnter:function(t,e,a){a(function(t){t.statistic=JSON.parse(t.$route.params.statistic)})}}},388:function(t,e,a){Object.defineProperty(e,"__esModule",{value:!0}),e.default={data:function(){return{orderLeftTime:"",startTime:"",timer:null}},methods:{goHome:function(){this.$router.push({name:"posHome"})},addNumber:function(t){return t>9?t:"0"+t},getLeftTime:function(){var t=this,e=this.startTime.getTime()+1e4,a=e-(new Date).getTime(),i=this.addNumber(Math.floor(a/1e3%60));this.orderLeftTime=i+" 秒后返回首页",a>0?this.timer=setTimeout(function(){t.getLeftTime()},1e3):(this.orderLeftTime="",this.goHome())}},destroyed:function(){clearTimeout(this.timer),this.timer=null},created:function(){this.startTime=new Date,this.getLeftTime()}}},408:function(t,e,a){e=t.exports=a(353)(!1),e.push([t.i,".init-style[data-v-3dba5412]{position:absolute;right:0;left:0;top:47px;bottom:0}aside.el-aside[data-v-3dba5412]{padding:10px}aside.el-aside .statistic .statistic-main[data-v-3dba5412]{padding:10px 20px;min-height:100px}aside.el-aside .statistic .statistic-main .item[data-v-3dba5412]{font-weight:400;padding:5px 0;font-size:16px}aside.el-aside .statistic .statistic-main .item.discount[data-v-3dba5412]{color:#4caf50}aside.el-aside .statistic .statistic-main .item.need-pay[data-v-3dba5412]{color:#ff9800}aside.el-aside .resting-order[data-v-3dba5412]{margin-top:10px}aside.el-aside .resting-order .el-card__body[data-v-3dba5412]{padding:0}.el-footer[data-v-3dba5412]{background-color:#b3c0d1;color:#333;height:200px!important;padding:20px;position:relative}.el-footer .gopay[data-v-3dba5412]{position:absolute;right:20px;top:20px}.el-aside[data-v-3dba5412]{background-color:#d3dce6;color:#333}.el-aside .exe-name[data-v-3dba5412]{margin-bottom:10px;text-align:center}.el-aside .exe-name .name[data-v-3dba5412]{font-weight:700}.el-aside .exe-name .name b[data-v-3dba5412]{color:red;font-size:40px;vertical-align:sub}.el-aside .exe-name .customer[data-v-3dba5412]{padding:10px;color:#009688;position:relative}.el-aside .exe-name .customer .headImg[data-v-3dba5412]{display:block;margin:auto;width:60px;height:60px;border-radius:50%;border:1px solid #ddd;margin-bottom:5px}.el-aside .exe-name .customer .vip[data-v-3dba5412]{position:absolute;font-size:25px;top:47px;right:95px;color:#8bc34a}.el-aside .exe-name .balance[data-v-3dba5412]{padding:10px;color:#ff9800;font-size:17px;border-top:1px solid #f1f1f1;text-align:right}.el-main[data-v-3dba5412]{background-color:#e9eef3;color:#333;display:-webkit-box;display:-ms-flexbox;display:flex}body>.el-container[data-v-3dba5412]{margin-bottom:40px}",""])},412:function(t,e,a){e=t.exports=a(353)(!1),e.push([t.i,".init-style[data-v-537323c2]{position:absolute;right:0;left:0;top:47px;bottom:0;background-color:#e9eef3}.el-main[data-v-537323c2]{color:#333;text-align:center;padding:40px 20%}.el-main .box-card[data-v-537323c2]{min-height:300px;position:relative}.el-main .box-card .el-card__header[data-v-537323c2]{position:relative}.el-main .box-card .el-card__header .left-time[data-v-537323c2]{padding:3px 0;position:absolute;left:20px;color:#f44336}.el-main .box-card .el-card__header .go-home[data-v-537323c2]{position:absolute;right:20px;padding:3px 0;font-size:16px}.el-main .box-card .el-card__header .title[data-v-537323c2]{vertical-align:middle}.el-main .box-card .el-card__body[data-v-537323c2]{padding:0}.el-main .box-card .pay-item .item[data-v-537323c2]{padding:10px;font-weight:400}.el-main .box-card .pay-item .item-balance[data-v-537323c2]{padding-top:40px}.el-main .box-card .pay-item .item-pay[data-v-537323c2]{margin-bottom:40px}.el-main .box-card .pay-item .balance[data-v-537323c2]{background:#adc7e8;padding:10px 20px;text-align:right;color:#fff;font-weight:700}",""])},421:function(t,e,a){e=t.exports=a(353)(!1),e.push([t.i,".init-style[data-v-9a35a876]{position:absolute;right:0;left:0;top:47px;bottom:0;background-color:#e9eef3}.el-main[data-v-9a35a876]{background-color:#e9eef3;color:#333;text-align:center;padding:40px 20%}.el-main .box-card .pay-item .item[data-v-9a35a876]{padding:10px;font-weight:400}.el-main .box-card .pay-item .pay-button[data-v-9a35a876]{border-top:1px solid #f1f1f1;margin:0 10%;padding:10px;text-align:right}",""])},432:function(t,e,a){var i=a(408);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a(354)("948c8acc",i,!0,{})},436:function(t,e,a){var i=a(412);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a(354)("34e91d04",i,!0,{})},445:function(t,e,a){var i=a(421);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a(354)("96c29498",i,!0,{})},451:function(t,e,a){t.exports=a.p+"static/img/headImg.8d19787.jpg"},456:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("keep-alive",[a("router-view")],1)],1)},staticRenderFns:[]}},462:function(t,e,a){t.exports={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"init-style"},[i("el-container",{staticStyle:{height:"100%"}},[i("el-container",[i("el-container",[i("el-main",[i("el-table",{staticStyle:{width:"100%",height:"100%"},attrs:{data:t.computedTableData,border:""}},[i("el-table-column",{attrs:{fixed:"",prop:"date",label:"序号",type:"index",width:"100"}}),t._v(" "),i("el-table-column",{attrs:{prop:"plu",label:"条码/编号",width:"120"}}),t._v(" "),i("el-table-column",{attrs:{prop:"des",label:"商品描述","min-width":"200"}}),t._v(" "),i("el-table-column",{attrs:{prop:"count",label:"数量",width:"100"}}),t._v(" "),i("el-table-column",{attrs:{prop:"price",label:"单价",width:"100"}}),t._v(" "),i("el-table-column",{attrs:{label:"折扣",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("money")(e.row.discount)))]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"金额",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("money")(e.row.act_price)))]}}])}),t._v(" "),i("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{type:"text",size:"medium"},nativeOn:{click:function(a){a.preventDefault(),t.deleteRow(e.$index,t.tableData)}}},[t._v("移除")])]}}])})],1)],1),t._v(" "),i("el-footer",[i("el-input",{ref:"pos_cmd_input",attrs:{placeholder:"请录入"},nativeOn:{keyup:function(e){return"button"in e||13===e.keyCode?t.submitTest(e):null}},model:{value:t.inputData,callback:function(e){t.inputData=e},expression:"inputData"}}),t._v(" "),t.tableData.length<=0?i("el-button",{staticClass:"gopay",attrs:{disabled:"",type:"primary"},on:{click:t.pay}},[t._v("去支付")]):i("el-button",{staticClass:"gopay",attrs:{type:"primary"},on:{click:t.pay}},[t._v("去支付")])],1)],1),t._v(" "),i("el-aside",{attrs:{width:"300px"}},[i("el-card",{staticClass:"box-card exe-name"},[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[i("span",{staticClass:"name"},[i("b",[t._v("M6")])])]),t._v(" "),t.userInfo.user_name?i("div",{staticClass:"customer"},[i("img",{staticClass:"headImg",attrs:{src:a(451),alt:""}}),t._v("\n            "+t._s(t.userInfo.user_name)+"("+t._s(t.userInfo.card_no)+")\n            "),"V"===t.userInfo.class?i("i",{staticClass:"iconfont vip"},[t._v("")]):t._e()]):i("div",{staticClass:"customer"},[t._v("\n            亲爱的M6用户\n          ")]),t._v(" "),t.userInfo.user_name?i("div",{staticClass:"balance"},[i("span",[t._v("卡余额：￥"+t._s(t.userInfo.balance))])]):t._e()]),t._v(" "),i("el-card",{staticClass:"box-card statistic"},[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[i("span",[t._v("Statistic")])]),t._v(" "),i("div",{staticClass:"statistic-main"},[i("h3",{staticClass:"item"},[t._v("商品种类："),i("b",[t._v(t._s(t.statistic.kind))]),t._v(" 种")]),t._v(" "),i("h3",{staticClass:"item"},[t._v("商品件数："),i("b",[t._v(t._s(t.statistic.num))]),t._v(" 件")]),t._v(" "),i("hr"),t._v(" "),i("h3",{staticClass:"item"},[t._v("小计金额："),i("b",[t._v(t._s(t._f("money")(t.statistic.totalPrice)))]),t._v(" 元")]),t._v(" "),"V"===t.userInfo.class?i("h3",{staticClass:"item discount"},[t._v("vip折让："),i("b",[t._v(t._s(t._f("money")(t.statistic.discount)))]),t._v(" 元")]):i("h3",{staticClass:"item discount"},[t._v("用卡折让："),i("b",[t._v(t._s(t._f("money")(t.statistic.discount)))]),t._v(" 元")]),t._v(" "),i("hr"),t._v(" "),i("h3",{staticClass:"item need-pay"},[t._v("结算金额："),i("b",[t._v(t._s(t._f("money")(t.statistic.needPay)))]),t._v(" 元")])])]),t._v(" "),i("el-card",{staticClass:"box-card resting-order",attrs:{hidden:""}},[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[i("span",[t._v("当前挂单列表")])]),t._v(" "),i("div",{staticClass:"resting-order-main"},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData2,stripe:""}},[i("el-table-column",{attrs:{prop:"date",label:"库号",width:""}}),t._v(" "),i("el-table-column",{attrs:{prop:"name",label:"客户",width:""}}),t._v(" "),i("el-table-column",{attrs:{prop:"address",label:"记数"}}),t._v(" "),i("el-table-column",{attrs:{prop:"address",label:"操作"}}),t._v(" "),i("el-table-column",{attrs:{prop:"address",label:"时间"}})],1)],1)]),t._v(" "),i("el-card",{staticClass:"box-card resting-order vouchers",attrs:{hidden:""}},[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[i("span",[t._v("当前使用抵用券列表")])]),t._v(" "),i("div",{staticClass:"resting-order-main"},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData3,stripe:""}},[i("el-table-column",{attrs:{prop:"date",label:"序号",width:""}}),t._v(" "),i("el-table-column",{attrs:{prop:"name",label:"商品描述",width:""}}),t._v(" "),i("el-table-column",{attrs:{prop:"address",label:"券值"}}),t._v(" "),i("el-table-column",{attrs:{prop:"address",label:"券号"}})],1)],1)])],1)],1)],1)],1)},staticRenderFns:[]}},466:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"init-style"},[a("el-container",[a("el-main",[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",{staticClass:"left-time"},[t._v(t._s(t.orderLeftTime))]),t._v(" "),a("span",{staticClass:"title"},[t._v("支付结果")]),t._v(" "),a("el-button",{staticClass:"go-home",attrs:{type:"text"},on:{click:t.goHome}},[t._v("返回首页")])],1),t._v(" "),a("div",{staticClass:"pay-item"},[a("h3",{staticClass:"item item-balance"},[t._v("卡余额：1.00")]),t._v(" "),a("h3",{staticClass:"item item-pay"},[t._v("支付扣除：1.00")]),t._v(" "),a("div",{staticClass:"balance"},[t._v("\n            卡内余额：￥68.65\n          ")])])])],1)],1),t._v(" "),a("el-button",{staticClass:"open-door-button",attrs:{type:"success"}},[t._v("开门")])],1)},staticRenderFns:[]}},476:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"init-style"},[a("el-container",[a("el-main",[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("账单详情")])]),t._v(" "),a("div",{staticClass:"pay-item"},[a("h3",{staticClass:"item"},[t._v("商品种类："),a("b",[t._v(t._s(t.statistic.kind))]),t._v(" 种")]),t._v(" "),a("h3",{staticClass:"item"},[t._v("商品件数："),a("b",[t._v(t._s(t.statistic.num))]),t._v(" 件")]),t._v(" "),a("h3",{staticClass:"item"},[t._v("合计金额："),a("b",[t._v(t._s(t._f("money")(t.statistic.totalPrice)))]),t._v(" 元")]),t._v(" "),a("h3",{staticClass:"item discount"},[t._v("用卡折让："),a("b",[t._v(t._s(t._f("money")(t.statistic.discount)))]),t._v(" 元")]),t._v(" "),a("h3",{staticClass:"item need-pay"},[t._v("结算金额："),a("b",[t._v(t._s(t._f("money")(t.statistic.needPay)))]),t._v(" 元")]),t._v(" "),a("div",{staticClass:"pay-button"},[a("el-button",{attrs:{type:"primary"},on:{click:t.payConfirm}},[t._v("确认支付")])],1)])])],1)],1)],1)},staticRenderFns:[]}}});